# 信号加窗方法：各种窗函数及其功率谱

窗函数在信号处理中用于减少频谱泄露。矩形窗提供最高的频率分辨率但泄露最大。汉宁窗和汉明窗通过平滑边缘减少泄露，后者旁瓣衰减更佳。Barthann窗结合了Bartlett和Hann窗的优点，提供平滑过渡和快速旁瓣衰减。Cosine窗以简单的余弦形状减少泄露，旁瓣低但主瓣略宽。选择窗函数需平衡频率分辨率与旁瓣抑制需求。

本文展示了几种经典窗函数的形状和功率谱，这也是一个实用工具，可以选择多种窗函数进行展示。

[Windowed Function as The Preprocessing of Discrete Fourier Transform](https://observablehq.com/@listenzcc/windowed-function-as-the-preprocessing-of-discrete-fourie)

---
[toc]

## 何为信号加窗

在数字信号处理中，信号加窗是一种常用的技术，旨在改善频谱分析的结果，特别是在分析非周期信号或有限长度信号时。本质上，加窗就是将一个窗函数与原始信号相乘，以减少信号两端的不连续性，从而减少频谱分析中的泄露效应和旁瓣效应。

信号加窗的必要性来源于对信号进行傅里叶变换时的基本假设——信号是周期性的。对于非周期信号或有限长度信号，直接进行傅里叶变换将导致信号在分析窗口边界处的不连续，这种不连续会在频谱中产生额外的频率成分，即泄露效应，造成频谱失真。通过使用窗函数，可以平滑信号的边界，从而减少泄露效应，使得频谱分析的结果更加准确。

## 各种窗函数及其功率谱

在信号加窗技术中，不同的窗函数有着不同的特性和应用场景。以下是一些经典窗函数及其功率谱的简介：

1. **矩形窗（Rectangular Window）**:
    - **形状**：在窗口长度内为常数值1，之外为0。
    - **功率谱**：主瓣最宽，旁瓣衰减最慢，泄露效应最大，但频率分辨率最高。
2. **汉宁窗（Hanning Window）**:
    - **形状**：由余弦函数构成，边缘向0平滑过渡，减少了边界处的不连续性。
    - **功率谱**：主瓣宽于矩形窗，旁瓣衰减速度更快，泄露效应较小。
3. **汉明窗（Hamming Window）**:
    - **形状**：与汉宁窗相似，但在构造中使用了不同的系数，以达到更优的旁瓣衰减效果。
    - **功率谱**：旁瓣相比汉宁窗更低，但主瓣略宽，适用于旁瓣要求更严格的场合。
4. **Barthann窗（Bartlett-Hann Window）**:
    - **形状**：Barthann窗可以看作是Bartlett窗（三角窗）和Hann窗的结合体。它在窗口的两端使用余弦过渡，旨在结合Bartlett和Hann窗的优点，提供更平滑的边缘过渡。
    - **功率谱**：Barthann窗的功率谱显示出比纯Bartlett窗或Hann窗更快的旁瓣衰减，同时保持了较宽的主瓣宽度。这种特性使其既可以减少泄露效应，又能较好地保持频率分辨率。
5. **Cosine窗（Cosine Window）**:
    - **形状**：Cosine窗由一个简单的余弦波形构成，它在窗口内部提供了一个平滑的过渡，而在窗口外部为0。这种窗函数的设计理念是使用尽可能简单的函数来平滑信号边缘，以减少泄露。
    - **功率谱**：Cosine窗的功率谱特性通常表现为较窄的主瓣和较快的旁瓣衰减，相比于矩形窗，其旁瓣级别较低，但主瓣宽度略有增加。这使得Cosine窗在需要较好旁瓣抑制而又不过分牺牲频率分辨率的应用场景中非常有用。

本文展示了几种经典窗函数的形状（右子图）和功率谱（左子图），这也是一个实用工具，可以选择多种窗函数进行展示。

![Untitled](%E4%BF%A1%E5%8F%B7%E5%8A%A0%E7%AA%97%E6%96%B9%E6%B3%95%EF%BC%9A%E5%90%84%E7%A7%8D%E7%AA%97%E5%87%BD%E6%95%B0%E5%8F%8A%E5%85%B6%E5%8A%9F%E7%8E%87%E8%B0%B1%206beb5d913e684be290fdf70abb2ab009/Untitled.png)

![Untitled](%E4%BF%A1%E5%8F%B7%E5%8A%A0%E7%AA%97%E6%96%B9%E6%B3%95%EF%BC%9A%E5%90%84%E7%A7%8D%E7%AA%97%E5%87%BD%E6%95%B0%E5%8F%8A%E5%85%B6%E5%8A%9F%E7%8E%87%E8%B0%B1%206beb5d913e684be290fdf70abb2ab009/Untitled%201.png)

[Windowed Function as The Preprocessing of Discrete Fourier Transform](https://observablehq.com/@listenzcc/windowed-function-as-the-preprocessing-of-discrete-fourie)